import{l as e,b as a,r as t,n as l,q as n,y as r,ay as u,A as i,U as s,X as o,a6 as d,H as m,u as c,ak as p,_ as v,V as b,W as f,a5 as N,aB as y,a8 as V,Q as g}from"./BlNbczg5.js";import{E as x}from"./H667Tzrd.js";import{S as E,aA as h,C as S,D as I,G as A,I as _,B as w,J as F,T as k,R as B,bv as $,k as M,Q as D,bw as j,O as C,Z as G}from"#entry";import{U as K,I as O,C as R,u as T,t as z,d as L}from"./CaAwZgye.js";import{v as X}from"./D4Cy1SFj.js";import{u as P,b as Q,a as U}from"./BxaPDu9A.js";const q=S({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.MAX_SAFE_INTEGER},min:{type:Number,default:Number.MIN_SAFE_INTEGER},modelValue:{type:[Number,null]},readonly:Boolean,disabled:Boolean,size:A,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>null===e||E(e)||["min","max"].includes(e),default:null},name:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0},...T(["ariaLabel"]),inputmode:{type:I(String),default:void 0},align:{type:I(String),default:"center"},disabledScientific:Boolean}),H={[R]:(e,a)=>a!==e,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[O]:e=>E(e)||h(e),[K]:e=>E(e)||h(e)},J=e({name:"ElInputNumber"});const W=G(_(e({...J,props:q,emits:H,setup(e,{expose:S,emit:I}){const A=e,{t:_}=w(),G=F("input-number"),T=a(),q=t({currentValue:A.modelValue,userInput:null}),{formItem:H}=P(),J=l(()=>E(A.modelValue)&&A.modelValue<=A.min),W=l(()=>E(A.modelValue)&&A.modelValue>=A.max),Z=l(()=>{const e=ne(A.step);return k(A.precision)?Math.max(ne(A.modelValue),e):(A.precision,A.precision)}),Y=l(()=>A.controls&&"right"===A.controlsPosition),ee=Q(),ae=U(),te=l(()=>{if(null!==q.userInput)return q.userInput;let e=q.currentValue;if(h(e))return"";if(E(e)){if(Number.isNaN(e))return"";k(A.precision)||(e=e.toFixed(A.precision))}return e}),le=(e,a)=>{if(k(a)&&(a=Z.value),0===a)return Math.round(e);let t=String(e);const l=t.indexOf(".");if(-1===l)return e;if(!t.replace(".","").split("")[l+a])return e;const n=t.length;return"5"===t.charAt(n-1)&&(t=`${t.slice(0,Math.max(0,n-1))}6`),Number.parseFloat(Number(t).toFixed(a))},ne=e=>{if(h(e))return 0;const a=e.toString(),t=a.indexOf(".");let l=0;return-1!==t&&(l=a.length-t-1),l},re=(e,a=1)=>E(e)?e>=Number.MAX_SAFE_INTEGER&&1===a||e<=Number.MIN_SAFE_INTEGER&&-1===a?e:le(e+A.step*a):q.currentValue,ue=e=>{var a;const t=e;if(A.disabledScientific&&["e","E"].includes(t.key))return void t.preventDefault();const l={[C.up]:()=>{t.preventDefault(),ie()},[C.down]:()=>{t.preventDefault(),se()}};null==(a=l[t.key])||a.call(l)},ie=()=>{if(A.readonly||ae.value||W.value)return;const e=Number(te.value)||0,a=re(e);de(a),I(O,q.currentValue),be()},se=()=>{if(A.readonly||ae.value||J.value)return;const e=Number(te.value)||0,a=re(e,-1);de(a),I(O,q.currentValue),be()},oe=(e,a)=>{const{max:t,min:l,step:n,precision:r,stepStrictly:u,valueOnClear:i}=A;t<l&&z("InputNumber","min should not be greater than max.");let s=Number(e);if(h(e)||Number.isNaN(s))return null;if(""===e){if(null===i)return null;s=g(i)?{min:l,max:t}[i]:i}return u&&(s=le(Math.round(s/n)*n,r),s!==e&&a&&I(K,s)),k(r)||(s=le(s,r)),(s>t||s<l)&&(s=s>t?t:l,a&&I(K,s)),s},de=(e,a=!0)=>{var t;const l=q.currentValue,n=oe(e);a?l===n&&e||(q.userInput=null,I(K,n),l!==n&&I(R,n,l),A.validateEvent&&(null==(t=null==H?void 0:H.validate)||t.call(H,"change").catch(e=>L())),q.currentValue=n):I(K,n)},me=e=>{q.userInput=e;const a=""===e?null:Number(e);I(O,a),de(a,!1)},ce=e=>{const a=""!==e?Number(e):"";(E(a)&&!Number.isNaN(a)||""===e)&&de(a),be(),q.userInput=null},pe=e=>{I("focus",e)},ve=e=>{var a,t;q.userInput=null,null===q.currentValue&&(null==(a=T.value)?void 0:a.input)&&(T.value.input.value=""),I("blur",e),A.validateEvent&&(null==(t=null==H?void 0:H.validate)||t.call(H,"blur").catch(e=>L()))},be=()=>{q.currentValue!==A.modelValue&&(q.currentValue=A.modelValue)},fe=e=>{document.activeElement===e.target&&e.preventDefault()};return n(()=>A.modelValue,(e,a)=>{const t=oe(e,!0);null===q.userInput&&t!==a&&(q.currentValue=t)},{immediate:!0}),n(()=>A.precision,()=>{q.currentValue=oe(A.modelValue)}),r(()=>{var e;const{min:a,max:t,modelValue:l}=A,n=null==(e=T.value)?void 0:e.input;if(n.setAttribute("role","spinbutton"),Number.isFinite(t)?n.setAttribute("aria-valuemax",String(t)):n.removeAttribute("aria-valuemax"),Number.isFinite(a)?n.setAttribute("aria-valuemin",String(a)):n.removeAttribute("aria-valuemin"),n.setAttribute("aria-valuenow",q.currentValue||0===q.currentValue?String(q.currentValue):""),n.setAttribute("aria-disabled",String(ae.value)),!E(l)&&null!=l){let e=Number(l);Number.isNaN(e)&&(e=null),I(K,e)}n.addEventListener("wheel",fe,{passive:!1})}),u(()=>{var e,a;const t=null==(e=T.value)?void 0:e.input;null==t||t.setAttribute("aria-valuenow",`${null!=(a=q.currentValue)?a:""}`)}),S({focus:()=>{var e,a;null==(a=null==(e=T.value)?void 0:e.focus)||a.call(e)},blur:()=>{var e,a;null==(a=null==(e=T.value)?void 0:e.blur)||a.call(e)}}),(e,a)=>(s(),i("div",{class:v([c(G).b(),c(G).m(c(ee)),c(G).is("disabled",c(ae)),c(G).is("without-controls",!e.controls),c(G).is("controls-right",c(Y)),c(G).is(e.align,!!e.align)]),onDragstart:V(()=>{},["prevent"])},[e.controls?o((s(),i("span",{key:0,role:"button","aria-label":c(_)("el.inputNumber.decrease"),class:v([c(G).e("decrease"),c(G).is("disabled",c(J))]),onKeydown:p(se,["enter"])},[b(e.$slots,"decrease-icon",{},()=>[m(c(M),null,{default:f(()=>[c(Y)?(s(),N(c(B),{key:0})):(s(),N(c($),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[c(X),se]]):d("v-if",!0),e.controls?o((s(),i("span",{key:1,role:"button","aria-label":c(_)("el.inputNumber.increase"),class:v([c(G).e("increase"),c(G).is("disabled",c(W))]),onKeydown:p(ie,["enter"])},[b(e.$slots,"increase-icon",{},()=>[m(c(M),null,{default:f(()=>[c(Y)?(s(),N(c(D),{key:0})):(s(),N(c(j),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[c(X),ie]]):d("v-if",!0),m(c(x),{id:e.id,ref_key:"input",ref:T,type:"number",step:e.step,"model-value":c(te),placeholder:e.placeholder,readonly:e.readonly,disabled:c(ae),size:c(ee),max:e.max,min:e.min,name:e.name,"aria-label":e.ariaLabel,"validate-event":!1,inputmode:e.inputmode,onKeydown:ue,onBlur:ve,onFocus:pe,onInput:me,onChange:ce},y({_:2},[e.$slots.prefix?{name:"prefix",fn:f(()=>[b(e.$slots,"prefix")])}:void 0,e.$slots.suffix?{name:"suffix",fn:f(()=>[b(e.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","inputmode"])],42,["onDragstart"]))}}),[["__file","input-number.vue"]]));export{W as E};
