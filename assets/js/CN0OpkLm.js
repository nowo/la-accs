import{E as e}from"./H667Tzrd.js";import{a,E as t}from"./DbH7GBFV.js";import{E as l}from"./BYvEgvwB.js";import{a as i,b as d}from"./Bk5xpA7T.js";import{_ as r}from"./BnM2IXaE.js";import{b as o,bx as s,j as u,E as m}from"#entry";import"./CaAwZgye.js";import{u as n,a as p}from"./CBCYgbPi.js";import{l as c,b,r as f,n as _,a5 as h,U as g,W as j,H as v,u as y,A as V,G as w,am as x}from"./BlNbczg5.js";import"./BxaPDu9A.js";import"./DPNR9bvN.js";import"./D4Cy1SFj.js";import"./B20wI0mL.js";import"./BCo6x5W8.js";import"./DYUhSIt8.js";import"./DIG7BEjY.js";import"./DxlzRKXL.js";const q=c({__name:"ApplyModal",emits:["update"],setup(c,{expose:q,emit:L}){const{t:z}=o(),U=L,A=b(),C=f({visible:!1,ready:!1,typeList:{create:z("account_create"),destroy:z("account_destroy")}}),E=_(()=>"add"===A.value?{title:z("create")}:{title:z("edit")}),k=b(),M=f({data:{id:0,p_id:0,title:"",title_en:"",href:"",icon:"",sort:0,status:1,imgList:[]}}),F=f({title:[{required:!0,whitespace:!0,message:z("required"),trigger:"blur"}],title_en:[{required:!0,whitespace:!0,message:z("required"),trigger:"blur"}],href:[{required:!0,whitespace:!0,message:z("required"),trigger:"blur"}],img:[{required:!0,whitespace:!0,message:z("required"),trigger:"blur"}]}),N=()=>{k.value?.resetFields()},[O,P]=n(async()=>{if(!(await p(k.value)))return;const e={account_email:M.data.title?.trim()??"",account_timezone:M.data.href?.trim()??"",account_count:Number(M.data.sort),account_type:M.data.icon?.trim()??""};if("add"===A.value)return!1;if("edit"===A.value){const a={...e,id:M.data.id},t=await u("/api/v1/menu/edit",{method:"POST",body:a});if(200!==t.code)return m.error(t.msg);m.success("修改成功")}U("update"),C.visible=!1});return q({openModal:(e,a)=>{A.value=e,"edit"===e&&a?(M.data.id=a.id,M.data.title=a.title||"",M.data.title_en=a.title_en||"",M.data.href=a.href||"",M.data.sort=a.sort||0,M.data.p_id=a.parent_id||"",M.data.status=a.status?1:0,M.data.imgList=a.icon?[a.icon]:[]):(M.data.id=0,M.data.title="",M.data.title_en="",M.data.href="",M.data.sort=0,M.data.status=1,M.data.icon="",M.data.imgList=[],a&&(M.data.p_id="number"==typeof a.id?a.id:"")),C.visible=!0}}),(o,u)=>{const m=e,n=t,p=l,c=d,b=i,f=a,_=r;return g(),h(_,{modelValue:y(C).visible,"onUpdate:modelValue":u[4]||(u[4]=e=>y(C).visible=e),"hide-full":"",title:y(E).title,loading:y(P),width:"480px",size:"80%",class:"mo-drawer",direction:"btt",onCancel:N,onConfirm:y(O)},{default:j(()=>[v(f,{ref_key:"formRef",ref:k,"label-position":"top",model:y(M).data,rules:y(F),"label-width":"120px"},{default:j(()=>[v(n,{label:y(z)("email"),prop:"title"},{default:j(()=>[v(m,{modelValue:y(M).data.title,"onUpdate:modelValue":u[0]||(u[0]=e=>y(M).data.title=e),maxlength:"20",placeholder:y(z)("email_placeholder"),clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),v(n,{label:y(z)("count"),prop:"sort"},{default:j(()=>[v(p,{modelValue:y(M).data.sort,"onUpdate:modelValue":u[1]||(u[1]=e=>y(M).data.sort=e),min:0,max:1e4,placeholder:"",class:"w-[calc(100%-50px)]!"},null,8,["modelValue"])]),_:1},8,["label"]),v(n,{label:y(z)("timezone"),prop:"href"},{default:j(()=>[v(b,{modelValue:y(M).data.href,"onUpdate:modelValue":u[2]||(u[2]=e=>y(M).data.href=e),clearable:"",filterable:"",disabled:"edit"===y(A)},{default:j(()=>[(g(!0),V(w,null,x("timezoneList"in o?o.timezoneList:y(s),e=>(g(),h(c,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label"]),v(n,{label:y(z)("type"),prop:"icon"},{default:j(()=>[v(b,{modelValue:y(M).data.icon,"onUpdate:modelValue":u[3]||(u[3]=e=>y(M).data.icon=e),clearable:"",filterable:"",disabled:"edit"===y(A)},{default:j(()=>[(g(!0),V(w,null,x(y(C).typeList,(e,a)=>(g(),h(c,{key:a,label:e,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","loading","onConfirm"])}}}),L=Object.assign(q,{__name:"ApplyModal"});export{L as default};
